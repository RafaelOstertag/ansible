---

- name: Install node exporter
  pkgng:
    name: node_exporter
    state: present

- name: Is ZFS enabled
  stat:
    path: /zroot
  register: zfs

- name: Enable node exporter
  template:
    src: rc.conf.d/node_exporter
    dest: /usr/local/etc/rc.conf.d
    mode: "0644"
    owner: root
    group: wheel
  notify:
    - Restart FreeBSD node_exporter

- name: Start node exporter
  service:
    name: node_exporter
    state: started
