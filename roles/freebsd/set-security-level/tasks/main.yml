---

- name: Enable secure level
  when: "enable_secure_level"
  lineinfile:
    path: /etc/rc.conf
    create: true
    regexp: '^kern_securelevel_enable='
    line: "kern_securelevel_enable=\"YES\""
    state: present
  notify:
    - FreeBSD set secure level

- name: Disable secure level
  when: "not enable_secure_level"
  lineinfile:
    path: /etc/rc.conf
    create: true
    regexp: '^kern_securelevel_enable='
    line: "kern_securelevel_enable=\"NO\""
    state: present

- name: Set secure level
  when: "enable_secure_level"
  lineinfile:
    path: /etc/rc.conf
    create: true
    regexp: '^kern_securelevel='
    line: "kern_securelevel=\"{{ secure_level }}\""
    state: present

- name: Unset secure level
  when: "not enable_secure_level"
  lineinfile:
    path: /etc/rc.conf
    create: true
    regexp: '^kern_securelevel='
    line: "kern_securelevel=\"-1\""
    state: present
