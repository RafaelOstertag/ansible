wlan_if="wlan0"
wlan_iprange="192.168.101.0/24"
wlan_no_vpn="192.168.101.21 - 192.168.101.30"
lan_if="re0"
lan_iprange="192.168.103.0/24"
vpn_if="tun0"
vpn_iprange="192.168.102.0/24"

# ICMP
pass in proto icmp from $dmz1
pass in proto icmp6 from $dmz2

# Prometheus
pass in on $lan_if proto tcp from $prometheus_server to port { 9100 9124 } modulate state
pass in on $lan_if inet6 proto tcp from $prometheus_server6 to port { 9100 9124 } modulate state

# Table for sshsentinel
table <agentsmith> persist { !$lan_iprange }
# SSH whitelist
table <ssh-white-list> persist { $lan_iprange, $vpn_iprange }

# World wide ssh access
pass in on $lan_if proto tcp from <ssh-white-list> to port 22 modulate state
block in quick from <agentsmith>

# No TVPlus shit
block in quick on $wlan_if proto tcp to 193.247.167.136 - 193.247.167.250

pass in on $wlan_if proto { tcp, udp } from $wlan_iprange to $wlan_iprange port 53 modulate state
pass in on $wlan_if proto icmp from $wlan_iprange to $wlan_iprange
pass in on $wlan_if proto udp from port 68 to port 67

# DNS delegation
pass in on $lan_if proto { tcp, udp } from $dnsserver to port 53 modulate state
pass in on $lan_if inet6 proto { tcp, udp } from $dnsserver6 to port 53 modulate state

# That's vpn
pass in on $wlan_if proto udp from $wlan_iprange to port 1194
pass in on $lan_if proto udp from any to port 1194
# That's clients allowed to acces lan without vpn
pass in on $wlan_if proto { tcp udp } from $wlan_no_vpn to any modulate state

pass in on $vpn_if from $vpn_iprange to any modulate state
