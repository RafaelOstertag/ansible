---
# Creates mount points and fstab entries for FreeBSD NFS clients.
- include: common-createdir.yml

- name: FreeBSD | update nfsuserd_options in /etc/rc.conf
  lineinfile: dest=/etc/rc.conf regexp="^nfsuserd_options=" line="nfsuserd_options=\"-domain kruemel.home\""
  notify:
    - restart FreeBSD nfsuserd

- name: FreeBSD | update nfsuserd_enable in /etc/rc.conf
  lineinfile: dest=/etc/rc.conf regexp="^nfsuserd_enable=" line="nfsuserd_enable=\"YES\""
  notify:
    - restart FreeBSD nfsuserd

- name: FreeBSD | enable nfscbd in /etc/rc.conf
  lineinfile: dest=/etc/rc.conf regexp="^nfscbd_enable=" line="nfscbd_enable=\"YES\""
  notify:
    - restart FreeBSD nfscbd

- name: FreeBSD | enable rpcbind in /etc/rc.conf
  lineinfile: dest=/etc/rc.conf regexp="^rpcbind_enable=" line="rpcbind_enable=\"YES\""
  notify:
    - restart FreeBSD rpcbind

- name: FreeBSD | add /tank1 fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/tank1 name=/mnt/tank1

- name: FreeBSD | add /export/data fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/data name=/mnt/data

- name: FreeBSD | add /export/home fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/home name=/home

- name: FreeBSD | add /export/iso fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/iso name=/mnt/iso

- name: FreeBSD | add /export/files fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/files name=/mnt/files

- name: FreeBSD | add /export/config fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/config name=/mnt/config

- name: FreeBSD | add /export/media2 fstab entry
  mount: state=mounted fstype=nfs opts=nfsv4,rw src=gizmo.kruemel.home:/export/media2 name=/mnt/media2
