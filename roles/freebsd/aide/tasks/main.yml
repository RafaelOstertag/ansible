---

- name: Install aide
  pkgng:
    name: aide
    state: present

- name: Copy aide.conf
  copy:
    dest: /usr/local/etc/aide.conf
    src: aide/aide.conf
    mode: 0400
    owner: root
    group: wheel

- name: Add check aide daily
  cron:
    name: Aide check daily
    state: present
    job: "/usr/local/bin/aide --check | mailx -s \"Aide on {{ ansible_fqdn }}\" root"
    weekday: "Mon-Sat"
    day: "*"
    minute: "12"
    hour: "05"
    month: "*"

- name: Add update aide weekly
  cron:
    name: Aide update weekly
    state: present
    job: "/usr/local/bin/aide --update | mailx -s \"Aide on {{ ansible_fqdn }}\" root ; mv /var/db/aide/databases/aide.db.new /var/db/aide/databases/aide.db"
    weekday: "Sun"
    day: "*"
    minute: "12"
    hour: "05"
    month: "*"
