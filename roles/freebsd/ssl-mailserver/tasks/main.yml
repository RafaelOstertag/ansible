---

- name: create /etc/mail/tls
  file:
    path: /etc/mail/tls
    mode: 0755
    owner: root
    group: wheel
    state: directory
  when: 'not edge_mailserver'

- name: Copy SSL public keys to /etc/mail/tls
  copy:
    src: "ssl/pub/{{ ansible_fqdn }}.crt"
    dest: "/etc/mail/tls/{{ item }}.cert"
    mode: 0644
    owner: root
    group: smmsp
  notify:
    - FreeBSD restart sendmail
  with_items:
    - client
    - server
  when: 'not edge_mailserver'

- name: Copy SSL private keys to /etc/mail/tls
  copy:
    src: "ssl/priv/{{ ansible_fqdn }}.key"
    dest: "/etc/mail/tls/{{ item }}.key"
    mode: 0640
    owner: root
    group: smmsp
  notify:
    - FreeBSD restart sendmail
  with_items:
    - client
    - server
  when: 'not edge_mailserver'
