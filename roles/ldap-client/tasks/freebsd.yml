---
- name: FreeBSD | enable system pam
  copy: src=pam-system-freebsd backup=yes dest=/etc/pam.d/system mode=644

- name: FreeBSD | enable sshd pam
  copy: src=pam-sshd-freebsd backup=yes dest=/etc/pam.d/sshd mode=644

- name: FreeBSD | copy nslcd.conf
  copy: src=nslcd.conf.freebsd backup=yes dest=/usr/local/etc/nslcd.conf mode=640 group=nslcd

- name: FreeBSD | enable nss ldap group
  lineinfile: "dest=/etc/nsswitch.conf regexp='^group:' line='group: files ldap'"

- name: FreeBSD | enable nss ldap passwd
  lineinfile: "dest=/etc/nsswitch.conf regexp='^passwd:' line='passwd: files ldap'"

- name: FreeBSD | enable nslcd
  lineinfile: dest=/etc/rc.conf regexp="^nslcd_enable" line="nslcd_enable=\"YES\""
  notify:
    - restart FreeBSD nslcd
