---
- name: OpenBSD | install package
  openbsd_pkg: name={{ item }} state=present
  environment:
    PKG_PATH: "ftp://mirror.switch.ch/pub/OpenBSD/{{ ansible_kernel }}/packages/{{ ansible_machine }}/"
  with_items:
    - login_ldap
    
- name: OpenBSD | enable ypldap
  lineinfile: dest=/etc/rc.conf.local regexp="^ypldap_flags=" line="ypldap_flags=\"\""

- name: OpenBSD | enable ypbind
  lineinfile: dest=/etc/rc.conf.local regexp="^ypbind_flags=" line="ypbind_flags=\"\""

- name: OpenBSD | yp default domain
  copy: src=yp.defaultdomain.openbsd dest=/etc/defaultdomain

- name: OpenBSD | create yp directory
  file: dest=/etc/yp state=directory

- name: OpenBSD | yp kruemel.home file
  copy: src=yp.kruemel.home.openbsd dest=/etc/yp/kruemel.home

- name: OpenBSD | ypldap.conf
  copy: src=ypldap.conf.openbsd dest=/etc/ypldap.conf mode=640 owner=root

- name: OpenBSD | login.conf for {{ ansible_kernel }}
  copy: src=login.conf.openbsd.{{ ansible_kernel }} dest=/etc/login.conf
