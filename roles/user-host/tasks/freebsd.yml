---
- name: FreeBSD | install packages
  pkgng: name={{ item }} state=present
  with_items:
    - fvwm
    - gnome2-lite
    - xfce
    - thunderbird
    - firefox
    - xombrero
    - wireshark
    - gnupg
    - sudo
    - cups
    - subversion
    - git
    - w3m
    - lynx
    - mutt
    - valgrind
    - gimp
    - avahi-app
    - nss-pam-ldapd
    - geeqie
    - amanda-client
    - pgadmin3
    - rapidsvn
    - libreoffice

# Enable all services used by user software
- name: FreeBSD | enable dbus
  lineinfile: dest=/etc/rc.conf regexp="^dbus_enable" line="dbus_enable=\"YES\""
  notify:
    - Restart FreeBSD dbus

- name: FreeBSD | enable avahi_daemon
  lineinfile: dest=/etc/rc.conf regexp="^avahi_daemon_enable" line="avahi_daemon_enable=\"YES\""
  notify:
    - Restart FreeBSD avahi-daemon

- name: FreeBSD | enable hald
  lineinfile: dest=/etc/rc.conf regexp="^hald_enable" line="hald_enable=\"YES\""
  notify:
    - Restart FreeBSD hald

- name: FreeBSD | enable cups
  lineinfile: dest=/etc/rc.conf regexp="^cupsd_enable" line="cupsd_enable=\"YES\""
  notify:
    - Restart FreeBSD cupsd

- name: FreeBSD | enable cups_browsed
  lineinfile: dest=/etc/rc.conf regexp="^cups_browsed_enable" line="cups_browsed_enable=\"YES\""
  notify:
    - Restart FreeBSD cups-browsed

- name: FreeBSD | enable nscd
  lineinfile: dest=/etc/rc.conf regexp="^nscd_enable" line="nscd_enable=\"YES\""
  notify:
    - Restart FreeBSD nscd

- name: FreeBSD | enable amanda tcp
  lineinfile: dest=/etc/inetd.conf regexp="^amanda[\s]+stream[\s]+tcp[\s]+" line="amanda  stream  tcp     nowait  amanda  /usr/local/libexec/amanda/amandad amandad -auth=bsdtcp"
  notify:
    - Restart FreeBSD inetd

- name: FreeBSD | enable amanda tcp6
  lineinfile: dest=/etc/inetd.conf regexp="^amanda[\s]+stream[\s]+tcp6[\s]+" line="amanda  stream  tcp6     nowait  amanda  /usr/local/libexec/amanda/amandad amandad -auth=bsdtcp"
  notify:
    - Restart FreeBSD inetd

- name: FreeBSD | cups config
  copy: src=cupsd.conf.freebsd dest=/usr/local/etc/cups/cupsd.conf mode=640 owner=root group=cups
  notify:
    - Restart FreeBSD cupsd

- name: FreeBSD | cups-browsed config
  copy: src=cups-browsed.conf.freebsd dest=/usr/local/etc/cups/cups-browsed.conf mode=644
  notify:
    - Restart FreeBSD cups-browsed

- name: FreeBSD | install nsswitch.conf
  copy: src=nsswitch.conf.freebsd dest=/etc/nsswitch.conf mode=644
  notify:
    - Restart FreeBSD nscd
