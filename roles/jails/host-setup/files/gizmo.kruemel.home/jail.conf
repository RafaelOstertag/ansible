# Ansible managed file

mount.devfs;
mount.procfs;
mount.fdescfs;
ip4 = inherit;
ip6 = inherit;
ip6.addr = "fd3e:be3e:ec34::1";
ip4.addr = "192.168.100.1";

git {
	# We don't have to switch to an unprivileged user, since
	# we're running ssh, which takes care of that
	host.hostname = git;
	path = /usr/jails/git;
	mount = "/var/git /usr/jails/git/var/git nullfs rw 0 0";
	exec.start = "/bin/sh /etc/rc.d/sshd start";
	exec.stop = "/bin/sh /etc/rc.d/sshd stop";
}

nexus {
      host.hostname = nexus;
      path = /usr/jails/nexus;
      mount = "/var/nexus /usr/jails/nexus/var/nexus nullfs rw 0 0";
      exec.start = "/bin/sh /opt/nexus/bin/nexus start";
      exec.stop = "/bin/sh /opt/nexus/bin/nexus stop";
      exec.jail_user = nexus;
      # Required to make nexus (elasticsearch) work
      enforce_statfs=1;
}

nmapservice {
      host.hostname = nmapservice;
      path = /usr/jails/nmapservice;
      exec.start = "/usr/bin/env LISTEN=:40000 LOGPATH=/opt/nmapservice/logs /usr/sbin/daemon -p /opt/nmapservice/var/nmapservice.pid -P /opt/nmapservice/var/supervisor.pid -f /opt/nmapservice/nmapservice";
      exec.jail_user = nmapservice;
}

lastseenservice {
      host.hostname = lastseenservice;
      path = /usr/jails/lastseenservice;
      exec.start = "/usr/bin/env HTTP_PORT=40001 DATABASE_URL=jdbc:postgresql://megatron.kruemel.home/lastseenservice DATABASE_USERNAME=lastseenservice DATABASE_PASSWORD='I-/&wfL*;=TH>QUjTh<k&BhOE6VGW' /usr/sbin/daemon -p /opt/lastseenservice/var/lastseenservice.pid -P /opt/lastseenservice/var/supervisor.pid -f java -Dlogback.configurationFile=logback-jailconfig.xml -jar /opt/lastseenservice/lastseenservice.jar";
      exec.jail_user = lastseenservice;
}
      
rundeck {
	host.hostname = rundeck;
	path = /usr/jails/rundeck;
	exec.start = "/usr/local/etc/rc.d/rundeck start";
}

consul {
	host.hostname = consul;
	path = /usr/jails/consul;
	exec.start = "/usr/local/etc/rc.d/consul start";
}

nmapserviceproxy {
      host.hostname = nmapserviceproxy;
      path = /usr/jails/nmapserviceproxy;
      exec.start = "/usr/bin/env HTTP_PORT=40002 /usr/sbin/daemon -p /opt/nmapserviceproxy/var/nmapserviceproxy.pid -P /opt/nampserviceproxy/var/supervisor.pid -f java -Dlogback.configurationFile=logback-jailconfig.xml -jar /opt/nmapserviceproxy/nmapserviceproxy.jar";
      exec.jail_user = nmapserviceproxy;
}
