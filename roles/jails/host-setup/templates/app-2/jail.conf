# Ansible managed file

mount.devfs;
mount.procfs;
mount.fdescfs;
ip4 = inherit;
ip6 = inherit;

kafka {
      host.hostname = kafka;
      path = /usr/jails/kafka;
      exec.jail_user = root;
      exec.start = "/usr/local/etc/rc.d/kafka onestart";
      exec.stop = "/usr/local/etc/rc.d/kafka onestop";
}

zookeeper {
      host.hostname = zookeeper;
      path = /usr/jails/zookeeper;
      exec.jail_user = root;
      exec.start = "/usr/local/etc/rc.d/zookeeper onestart";
      exec.stop = "/usr/local/etc/rc.d/zookeeper onestop";
}

funnel-retriever {
      host.hostname = funnel-retriever;
      path = /usr/jails/funnel-retriever;
      mount.fstab = /usr/jails/thin-base/etc/fstab.jail.funnel-retriever;
      exec.start = "/usr/bin/env LOG_DIR=/opt/app/var/log SERVER_PORT=40003 KAFKA_SERVER=localhost:9092 /usr/local/bin/runjava11app.sh /opt/app/app.jar";
      exec.jail_user = app;
}

funnel-persistence {
      host.hostname = funnel-persistence;
      path = /usr/jails/funnel-persistence;
      mount.fstab = /usr/jails/thin-base/etc/fstab.jail.funnel-persistence;
      exec.start = "/usr/bin/env LOG_DIR=/opt/app/var/log SERVER_PORT=40004 MONGO_URL='{{ funnel_mongodb_url }}' KAFKA_SERVER=localhost:9092 /usr/local/bin/runjava11app.sh /opt/app/app.jar";
      exec.jail_user = app;
}

funnel-chronos {
      host.hostname = funnel-chronos;
      path = /usr/jails/funnel-chronos;
      mount.fstab = /usr/jails/thin-base/etc/fstab.jail.funnel-chronos;
      exec.start = "/usr/bin/env LOG_DIR=/opt/app/var/log SERVER_PORT=40005 MONGO_URL='{{ funnel_mongodb_url }}' KAFKA_SERVER=localhost:9092 /usr/local/bin/runjava11app.sh /opt/app/app.jar";
      exec.jail_user = app;
}

funnel-rest {
      host.hostname = funnel-rest;
      path = /usr/jails/funnel-rest;
      mount.fstab = /usr/jails/thin-base/etc/fstab.jail.funnel-rest;
      exec.start = "/usr/bin/env LOG_DIR=/opt/app/var/log SERVER_PORT=40006 MONGO_URL='{{ funnel_mongodb_url }}' KAFKA_SERVER=localhost:9092 /usr/local/bin/runjava11app.sh /opt/app/app.jar";
      exec.jail_user = app;
}

funnel-notifier {
      host.hostname = funnel-notifier;
      path = /usr/jails/funnel-notifier;
      mount.fstab = /usr/jails/thin-base/etc/fstab.jail.funnel-notifier;
      exec.start = "/usr/bin/env LOG_DIR=/opt/app/var/log SERVER_PORT=40007 KAFKA_SERVER=localhost:9092 SMTP_SERVER=localhost SMTP_RECIPIENT=rafael.ostertag@gmail.com /usr/local/bin/runjava11app.sh /opt/app/app.jar";
      exec.jail_user = app;
}
